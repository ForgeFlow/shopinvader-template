---
{
  "name": "Colissimo selector",
  "icon": "list",
  "settings": [
    {
      "label": "La Poste Colissimo ",
      "id": "help",
      "type": "hint"
    },
    {
      "label": "Token",
      "id": "token",
      "type": "text"
    },
    {
      "label": "Title",
      "id": "title",
      "type": "text"
    }
  ],
  "default": {
    "settings": {
      "token": "eyJhbGciOiJIUzI1NiJ9.eyJqdGkiOiJkNDNmMzI5ZDg1NWMxZTA4YzdlZjZkZGI1ZDZkYWRhZCIsImlhdCI6MTU1MzA5OTEwNiwic3ViIjoid2lkZ2V0IiwiaXNzIjoiODUzMDMyIiwiZXhwIjoxNTUzMTAwOTA2fQ.eSWYaFbHZ0PMw7ewKs07ATDzUCeUeX7JDxUvmwxHCO4",
      "title": "Colissimo - Find a drop off location"
    }
  }
}
---
<div>
  <div class="alert alert-info">
    <div class="h4">Colissimo Section</div>
  </div>
  <!-- Modal -->
  <div class="modal fade" id="modal-colissimo" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">
            {{section.settings.title}}
          </h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="widget-colissimo"></div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">
            {{'btn_close'}}
          </button>
          <button type="button" class="btn btn-primary">Save changes</button>
        </div>
      </div>
    </div>
  </div>
  {% action 'token' %}
    
  {% endaction %}

  {% capture 'js2' %}
    <script type="text/javascript" src="https://ws.colissimo.fr/widget-point-retrait/resources/js/jquery.plugin.colissimo.min.js"></script>
    <script type="text/javascript">
      
      function select_colissimo_point(point){
        console.log(point);
        $modal_colissimo.modal('hide');
      }
      $(document).ready(function () {
        var $modal_colissimo = $('#modal-colissimo');
         $modal_colissimo.modal('show');
        var colissimo_params = {
            "ceLang": "fr",
            "callBackFrame": `select_colissimo_point`,
            "URLColissimo": "https://ws.colissimo.fr",
            "ceCountryList": "FR,ES,GB,PT,DE",
            "ceCountry": "FR",
            "dyPreparationTime": "1",
            "ceAddress": "62 RUE CAMILLE DESMOULINS",
            "ceZipCode": "92130",
            "ceTown": "ISSY LES MOULINEAUX",
            "token": {{section.settings.token | json}}
          };
        console.log(colissimo_params);
        $('#widget-colissimo').frameColissimoOpen(colissimo_params);
      });
      
    </script>
  {% endcapture %}
  {% include js_footer with js_content: js2 %}
</div>